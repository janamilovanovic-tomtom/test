// Copyright (C) 2018 TomTom NV. All rights reserved.
//
// This software is the proprietary copyright of TomTom NV and its subsidiaries and may be
// used for internal evaluation purposes or commercial use strictly subject to separate
// license agreement between you and TomTom NV. If you are the licensee, you are only permitted
// to use this software in accordance with the terms of your license agreement. If you are
// not the licensee, you are not authorized to use this software in any manner and should
// immediately return or destroy it.

= navigation-instruction-text-generation depends on data access due to dependency to instruction-engine-interface

== Status

Accepted

== Context

The instruction-text-generation is using the instruction from the instruction-engine-interface to generate
the audio message. This is bringing unnecessary dependencies such as common component from mapdataaccess.

In the future we want to use the text-generation for online instructions but also for the warning handler.
Therefore the direct use of the NIE instruction in the handler might not be the best approach.

== Options
There are two cases we want to take into consideration when we make changes.
CASE_1 : A new field was introduced in the instruction and it has to be used ONLY for the text-generation
CASE_2 : A new field was introduced in the instruction and it does NOT need to be used from the text-generation.

Describe the steps.
1) Use a separate instruction type in nk2-navigation-instruction-text-generation
CASE_1
1.1 Add new field in the instruction of instruction-engine-interface
1.2 Extend the text-generation instruction
1.3 Add logic to use this field in text-generation
1.4 Adapt the trip-onboard-service adapter from instruction-engine-interface instruction to text-generation instruction
1.5 Propagate all three repos

CASE_2
1.1 Add new field in the instruction of instruction-engine-interface
1.2 Convert to protobuf instruction in trip-onboardservice
1.3 Propagate the intruction-engine-interface and trip-onboardservice.

Props:
- Faster build times
- Keep the current number of repos

Cons:
- More code.
- Changes that will be used by the text-generation will be more difficult and require more propagate.
More repos will be touched.
- More conan packages to propagate.

2) Extract the instruction to a separate repo with name INSTRUCTION-repo(not final name)
CASE_1
1.1 Add new field in the instruction of INSTRUCTION-repo
1.2 Add logic to use this field in text-generation
1.3 Propagate repos INSTRUCTION-repo and text-generation

CASE_2
1.1 Add new field in the instruction of instruction-engine-interface
1.2 Convert to protobuf instruction in trip-onboardservice
1.3 Propagate the intruction-engine-interface and trip-onboardservice.

Pros:
- Faster build times
- Less code duplication

Cons:
- One more repo just to hold an instruction
- More alignment problems

3) Do nothing
CASE_1
1.1 Add new field in the instruction of instruction-engine-interface
1.2 Add logic to use this field in text-generation
1.3 Propagate the intruction-engine-interface and text-generation.

CASE_2
1.1 Add new field in the instruction of instruction-engine-interface
1.2 Convert to protobuf instruction in trip-onboardservice
1.3 Propagate the intruction-engine-interface and trip-onboardservice.

Pros:
- Less code
- Changes to the instruction that will be used by the text-generation are easier

cons:
- Slower build time due to unnecessary dependencies
- unnecessary dependencies in the conanfile.ttlock

== Proposal

We decided to do nothing for now and postpone the work for later.
The vehicle horizon team has not started looking yet at the text-generation
repo and they don't know what they will need. As a result a refactoring at this
point could be thrown away once the VH team comes to extend the text-generation
for their needs.
